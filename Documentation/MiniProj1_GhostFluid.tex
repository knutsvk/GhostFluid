\documentclass[final,3p,twocolumn]{elsarticle}

\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{lipsum}

%% natbib.sty is loaded by default. However, natbib options can be
%% provided with \biboptions{...} command. Following options are
%% valid:

%%   round  -  round parentheses are used (default)
%%   square -  square brackets are used   [option]
%%   curly  -  curly braces are used      {option}
%%   angle  -  angle brackets are used    <option>
%%   semicolon  -  multiple citations separated by semi-colon
%%   colon  - same as semicolon, an earlier confusion
%%   comma  -  separated by comma
%%   numbers-  selects numerical citations
%%   super  -  numerical citations as superscripts
%%   sort   -  sorts multiple citations according to order in ref. list
%%   sort&compress   -  like sort, but also compresses numerical citations
%%   compress - compresses without sorting
%%
%% \biboptions{comma,round}

\biboptions{super, square}

\usepackage{tikz}
\usepackage{pgfplots}

\pgfplotsset{width=0.8\columnwidth, compat=1.8}
\usepgfplotslibrary{groupplots, external}
\tikzexternalize

\journal{MPhil in Scientific Computing}

\begin{document}

\begin{frontmatter}

\title{Multimaterial Simulations using the Ghost Fluid Method}

\author{Knut Sverdrup}

\address{Cavendish Laboratory, Department of Physics, J J Thomson
  Avenue, Cambridge. CB3 0HE}

\begin{abstract}
    The unsteady, compressible Euler equations for multimaterial flow in one
    dimension have been solved numerically by employing a level set method and
    two versions of the Ghost Fluid Method. 
\end{abstract}

\end{frontmatter}

%% main text
\section{Introduction}
\label{sec:introduction}

\subsection{Euler equations}
\label{subsec:euler}

The Euler equations govern adiabatic and inviscid flow of a fluid. In one dimension, with density $\rho$, velocity $u$, total energy $E$ and pressure $p$, they are given by 

\begin{equation}
    \frac{\partial {\bf U}}{\partial t} 
    + \frac{\partial {\bf F(U)}}{\partial x} = 0\,,
\end{equation}
%
where the vectors of conserved quantities ${\bf U}$ and their fluxes ${\bf F(U)}$ are given by

\begin{equation}
    {\bf U} = 
    \begin{pmatrix} 
        \rho \\ 
        \rho u \\ 
        E 
    \end{pmatrix}
    \,,\quad
    {\bf F} = 
    \begin{pmatrix}
        \rho u \\ 
        \rho u^2 + p \\
        u(E+p) 
    \end{pmatrix}
    \,.
\end{equation}
%
It is sometimes convenient to work in terms of the primary variables ${\bf W} = \begin{pmatrix} \rho, & u, & p \end{pmatrix}^T$. The total energy is the sum of the kinetic and potential energy of the system, i.e.~ 

\begin{equation}
    E = \frac{1}{2} \rho u^2 + \rho e \,,
\end{equation}
%
where $e$ is the internal energy, related to the other variables through the equation of state. For an ideal gas, the equation of state is 

\begin{equation}
     e = \frac{p}{(\gamma-1)p} \,,
 \end{equation}
%
where $\gamma$ denotes the ratio of specific heats for the gas. 
\subsection{Riemann problem}
\label{subsec:riemann}

\subsection{Multimaterial flow}
\label{subsec:multimaterial}

\section{Numerical methods}
\label{sec:numerical}

\subsection{Slope-Limiting Centered scheme (SLIC)}
\label{subsec:slic}

\subsection{Level-set method}
\label{subsec:levelset}

\subsection{Ghost Fluid Methods}
\label{subsec:ghostfluid}

\subsubsection{Original Ghost Fluid Method}
\label{subsubsec:ogfm}

\subsubsection{Riemann Ghost Fluid Method}
\label{subsubsec:rgfm}

\section{Results}
\label{sec:results}

\subsection{Moving contact discontinuity}
\label{subsec:moving}

\subsection{Simple ghost fluid tests}
\label{subsec:toro}

\subsection{Multimaterial shock tubes for gases}
\label{subsec:shocktubes}

\pgfplotstableread{../Results/testC_OGFM_N100.out}{\one}
\pgfplotstableread{../Results/testC_OGFM_N200.out}{\two}
\pgfplotstableread{../Results/testC_OGFM_N400.out}{\four}

\begin{figure*}[htb]
    \centering
    \begin{tikzpicture}
        \begin{groupplot}[
            width=1.1*\columnwidth, height=0.7\columnwidth,
            group style={group size=2 by 2}, 
            xlabel=$x$, xmin=0, xmax=1, 
            ylabel style={rotate=-90}]

            \nextgroupplot[ylabel=$\rho$]
            \addplot+[only marks, mark=triangle, color=teal, each nth point=1]
            table[x={x}, y={rho}]{\one};
            \addplot+[only marks, mark=x, color=red, each nth point=2]
            table[x={x}, y={rho}]{\two};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=4]
            table[x={x}, y={rho}]{\four};

            \nextgroupplot[ylabel=$u$, ytick pos=right]
            \addplot+[only marks, mark=triangle, color=teal, each nth point=1]
            table[x={x}, y={u}]{\one};
            \addplot+[only marks, mark=x, color=red, each nth point=2]
            table[x={x}, y={u}]{\two};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=4]
            table[x={x}, y={u}]{\four};

            \nextgroupplot[ylabel=$p$]
            \addplot+[only marks, mark=triangle, color=teal, each nth point=1]
            table[x={x}, y={p}]{\one};
            \addplot+[only marks, mark=x, color=red, each nth point=2]
            table[x={x}, y={p}]{\two};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=4]
            table[x={x}, y={p}]{\four};

            \nextgroupplot[ylabel=$e$, ytick pos=right]
            \addplot+[only marks, mark=triangle, color=teal, each nth point=1]
            table[x={x}, y={e}]{\one};
            \addplot+[only marks, mark=x, color=red, each nth point=2]
            table[x={x}, y={e}]{\two};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=4]
            table[x={x}, y={e}]{\four};

        \end{groupplot}
    \end{tikzpicture}
\caption{Original Ghost Fluid method for test C.
    \textcolor{teal}{$\triangle$}$N=100$
    \textcolor{red}{$\times$}$N=200$
    \textcolor{blue}{$\circ$}$N=400$ }
\label{fig:testC_OGFM}
\end{figure*}

\pgfplotstableread{../Results/testC_RGFM_N100.out}{\one}
\pgfplotstableread{../Results/testC_RGFM_N200.out}{\two}
\pgfplotstableread{../Results/testC_RGFM_N400.out}{\four}

\begin{figure*}[htb]
    \centering
    \begin{tikzpicture}
        \begin{groupplot}[
            width=1.1*\columnwidth, height=0.7\columnwidth,
            group style={group size=2 by 2}, 
            xlabel=$x$, xmin=0, xmax=1, 
            ylabel style={rotate=-90}]

            \nextgroupplot[ylabel=$\rho$]
            \addplot+[only marks, mark=triangle, color=teal, each nth point=1]
            table[x={x}, y={rho}]{\one};
            \addplot+[only marks, mark=x, color=red, each nth point=2]
            table[x={x}, y={rho}]{\two};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=4]
            table[x={x}, y={rho}]{\four};

            \nextgroupplot[ylabel=$u$, ytick pos=right]
            \addplot+[only marks, mark=triangle, color=teal, each nth point=1]
            table[x={x}, y={u}]{\one};
            \addplot+[only marks, mark=x, color=red, each nth point=2]
            table[x={x}, y={u}]{\two};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=4]
            table[x={x}, y={u}]{\four};

            \nextgroupplot[ylabel=$p$]
            \addplot+[only marks, mark=triangle, color=teal, each nth point=1]
            table[x={x}, y={p}]{\one};
            \addplot+[only marks, mark=x, color=red, each nth point=2]
            table[x={x}, y={p}]{\two};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=4]
            table[x={x}, y={p}]{\four};

            \nextgroupplot[ylabel=$e$, ytick pos=right]
            \addplot+[only marks, mark=triangle, color=teal, each nth point=1]
            table[x={x}, y={e}]{\one};
            \addplot+[only marks, mark=x, color=red, each nth point=2]
            table[x={x}, y={e}]{\two};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=4]
            table[x={x}, y={e}]{\four};

        \end{groupplot}
    \end{tikzpicture}
\caption{Riemann Ghost Fluid method for test C.
    \textcolor{teal}{$\triangle$}$N=100$
    \textcolor{red}{$\times$}$N=200$
    \textcolor{blue}{$\circ$}$N=400$ }
\label{fig:testC_RGFM}
\end{figure*}

\pgfplotstableread{../Results/testD_OGFM_N100.out}{\one}
\pgfplotstableread{../Results/testD_OGFM_N200.out}{\two}
\pgfplotstableread{../Results/testD_OGFM_N400.out}{\four}

\begin{figure*}[htb]
    \centering
    \begin{tikzpicture}
        \begin{groupplot}[
            width=1.1*\columnwidth, height=0.7\columnwidth,
            group style={group size=2 by 2}, 
            xlabel=$x$, xmin=0, xmax=1, 
            ylabel style={rotate=-90}]

            \nextgroupplot[ylabel=$\rho$]
            \addplot+[only marks, mark=triangle, color=teal, each nth point=1]
            table[x={x}, y={rho}]{\one};
            \addplot+[only marks, mark=x, color=red, each nth point=2]
            table[x={x}, y={rho}]{\two};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=4]
            table[x={x}, y={rho}]{\four};

            \nextgroupplot[ylabel=$u$, ytick pos=right]
            \addplot+[only marks, mark=triangle, color=teal, each nth point=1]
            table[x={x}, y={u}]{\one};
            \addplot+[only marks, mark=x, color=red, each nth point=2]
            table[x={x}, y={u}]{\two};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=4]
            table[x={x}, y={u}]{\four};

            \nextgroupplot[ylabel=$p$]
            \addplot+[only marks, mark=triangle, color=teal, each nth point=1]
            table[x={x}, y={p}]{\one};
            \addplot+[only marks, mark=x, color=red, each nth point=2]
            table[x={x}, y={p}]{\two};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=4]
            table[x={x}, y={p}]{\four};

            \nextgroupplot[ylabel=$e$, ytick pos=right]
            \addplot+[only marks, mark=triangle, color=teal, each nth point=1]
            table[x={x}, y={e}]{\one};
            \addplot+[only marks, mark=x, color=red, each nth point=2]
            table[x={x}, y={e}]{\two};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=4]
            table[x={x}, y={e}]{\four};

        \end{groupplot}
    \end{tikzpicture}
\caption{Original Ghost Fluid method for test D. 
    \textcolor{teal}{$\triangle$}$N=100$
    \textcolor{red}{$\times$}$N=200$
    \textcolor{blue}{$\circ$}$N=400$ }
\label{fig:testD_OGFM}
\end{figure*}

\pgfplotstableread{../Results/testD_RGFM_N100.out}{\one}
\pgfplotstableread{../Results/testD_RGFM_N200.out}{\two}
\pgfplotstableread{../Results/testD_RGFM_N400.out}{\four}

\begin{figure*}[htb]
    \centering
    \begin{tikzpicture}
        \begin{groupplot}[
            width=1.1*\columnwidth, height=0.7\columnwidth,
            group style={group size=2 by 2}, 
            xlabel=$x$, xmin=0, xmax=1, 
            ylabel style={rotate=-90}]

            \nextgroupplot[ylabel=$\rho$]
            \addplot+[only marks, mark=triangle, color=teal, each nth point=1]
            table[x={x}, y={rho}]{\one};
            \addplot+[only marks, mark=x, color=red, each nth point=2]
            table[x={x}, y={rho}]{\two};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=4]
            table[x={x}, y={rho}]{\four};

            \nextgroupplot[ylabel=$u$, ytick pos=right]
            \addplot+[only marks, mark=triangle, color=teal, each nth point=1]
            table[x={x}, y={u}]{\one};
            \addplot+[only marks, mark=x, color=red, each nth point=2]
            table[x={x}, y={u}]{\two};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=4]
            table[x={x}, y={u}]{\four};

            \nextgroupplot[ylabel=$p$]
            \addplot+[only marks, mark=triangle, color=teal, each nth point=1]
            table[x={x}, y={p}]{\one};
            \addplot+[only marks, mark=x, color=red, each nth point=2]
            table[x={x}, y={p}]{\two};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=4]
            table[x={x}, y={p}]{\four};

            \nextgroupplot[ylabel=$e$, ytick pos=right]
            \addplot+[only marks, mark=triangle, color=teal, each nth point=1]
            table[x={x}, y={e}]{\one};
            \addplot+[only marks, mark=x, color=red, each nth point=2]
            table[x={x}, y={e}]{\two};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=4]
            table[x={x}, y={e}]{\four};

        \end{groupplot}
    \end{tikzpicture}
\caption{Riemann Ghost Fluid method for test D. 
    \textcolor{teal}{$\triangle$}$N=100$
    \textcolor{red}{$\times$}$N=200$
    \textcolor{blue}{$\circ$}$N=400$ }
\label{fig:testD_RGFM}
\end{figure*}
\subsection{Water-gas shock tube test}
\label{subsec:water}

\pgfplotstableread{../Results/testE_RGFM_N100.out}{\one}
\pgfplotstableread{../Results/testE_RGFM_N200.out}{\two}
\pgfplotstableread{../Results/testE_RGFM_N400.out}{\four}
\pgfplotstableread{../Results/testE_RGFM_N1000.out}{\tausen}

\begin{figure*}[htb]
    \centering
    \begin{tikzpicture}
        \begin{groupplot}[
            width=1.1*\columnwidth, height=0.7\columnwidth,
            group style={group size=2 by 2}, 
            xlabel=$x$, xmin=0, xmax=1, 
            ylabel style={rotate=-90}]

            \nextgroupplot[ylabel=$\rho$]
            \addplot+[mark=none, color=black]
            table[x={x}, y={rhoEx}]{\tausen};
            \addplot+[only marks, mark=triangle, color=teal, each nth point=1]
            table[x={x}, y={rho}]{\one};
            \addplot+[only marks, mark=x, color=red, each nth point=2]
            table[x={x}, y={rho}]{\two};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=4]
            table[x={x}, y={rho}]{\four};

            \nextgroupplot[ylabel=$u$, ytick pos=right]
            \addplot+[mark=none, color=black]
            table[x={x}, y={uEx}]{\tausen};
            \addplot+[only marks, mark=triangle, color=teal, each nth point=1]
            table[x={x}, y={u}]{\one};
            \addplot+[only marks, mark=x, color=red, each nth point=2]
            table[x={x}, y={u}]{\two};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=4]
            table[x={x}, y={u}]{\four};

            \nextgroupplot[ylabel=$p$]
            \addplot+[mark=none, color=black]
            table[x={x}, y={pEx}]{\tausen};
            \addplot+[only marks, mark=triangle, color=teal, each nth point=1]
            table[x={x}, y={p}]{\one};
            \addplot+[only marks, mark=x, color=red, each nth point=2]
            table[x={x}, y={p}]{\two};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=4]
            table[x={x}, y={p}]{\four};

            \nextgroupplot[ylabel=$e$, ytick pos=right]
            \addplot+[mark=none, color=black]
            table[x={x}, y={eEx}]{\tausen};
            \addplot+[only marks, mark=triangle, color=teal, each nth point=1]
            table[x={x}, y={e}]{\one};
            \addplot+[only marks, mark=x, color=red, each nth point=2]
            table[x={x}, y={e}]{\two};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=4]
            table[x={x}, y={e}]{\four};

        \end{groupplot}
    \end{tikzpicture}
    \caption{Riemann Ghost Fluid method for test E.
    \textcolor{teal}{$\triangle$}$N=100$
    \textcolor{red}{$\times$}$N=200$
    \textcolor{blue}{$\circ$}$N=400$ }
\label{fig:testE_RGFM}
\end{figure*}

\begin{figure*}[htb]
    \centering
    \begin{tikzpicture}
        \begin{groupplot}[
            width=1.1*\columnwidth, height=0.7\columnwidth,
            group style={group size=2 by 2}, 
            xlabel=$x$, xmin=0, xmax=1, 
            ylabel style={rotate=-90}]

            \nextgroupplot[ylabel=$\rho$]
            \addplot+[mark=none, color=black]
            table[x={x}, y={rhoEx}]{\tausen};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=10]
            table[x={x}, y={rho}]{\tausen};

            \nextgroupplot[ylabel=$u$, ytick pos=right]
            \addplot+[mark=none, color=black]
            table[x={x}, y={uEx}]{\tausen};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=10]
            table[x={x}, y={u}]{\tausen};

            \nextgroupplot[ylabel=$p$]
            \addplot+[mark=none, color=black]
            table[x={x}, y={pEx}]{\tausen};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=10]
            table[x={x}, y={p}]{\tausen};

            \nextgroupplot[ylabel=$e$, ytick pos=right]
            \addplot+[mark=none, color=black]
            table[x={x}, y={eEx}]{\tausen};
            \addplot+[only marks, mark=o, color=blue,  mark size=1pt, each nth point=10]
            table[x={x}, y={e}]{\tausen};

        \end{groupplot}
    \end{tikzpicture}
\caption{Riemann Ghost Fluid method for test E with higher accuracy ($N=1000$).}
\label{fig:testE_RGFM_N1000}
\end{figure*}
\section{Conclusions}
\label{sec:conclucion}

\bibliographystyle{elsarticle-num}
\bibliography{references.bib}

\end{document}
